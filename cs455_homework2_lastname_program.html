import pandas
import math
df = pandas.read_csv("C:\\Users\\timot\\Desktop\\Spring2025\\CS455\\Homework\\cs455_homework2_dataset_Culp_Dager_Grim_Smith.csv")

def normalize_data(data):
    min = data.min()
    max = data.max()
    new_data = []
    for i in range(len(data)):
        new_value = (data[i] - min)/ (max - min )
        new_data.append(new_value)
    return new_data

def compute_distance_matrix(data):
    distance_matrix = []
    for i in range(len(data)):
        temp = []
        for j in range(len(data)):
            difference = round(math.fabs(data[i] - data[j]), 2)
            temp.append(difference)
        distance_matrix.append(temp)
    return distance_matrix

def compute_distance_nominal(data):
    distance_matrix = []
    for i in range(len(data)):
        temp = []
        for j in range(len(data)):
            if (data[i] != data[j]):
                difference = 1
            else: 
                difference = 0
            temp.append(difference)
        distance_matrix.append(temp)
    return distance_matrix


def compute_distance_final(co2Matrix, energyMatrix, regionMatrix, countryMatrix):
    distance_matrix = []
    for i in range(len(co2Matrix)):
        temp = []
        for j in range(len(co2Matrix)):
            sum = round((co2Matrix[i][j] +  energyMatrix[i][j] + regionMatrix[i][j] + countryMatrix[i][j])*(1/4),2)          
            temp.append(sum)
        distance_matrix.append(temp)
    return distance_matrix


def printMatrix(matrix):
    for row in matrix:
        print()
        for element in row:
            print(element, end = " ")

normalizedCo2 = normalize_data(df['Co2_Emissions_MetricTons'])
normalizedEnergyConsumption = normalize_data(df['Energy_Consumption_TWh'])

co2Matrix = compute_distance_matrix(normalizedCo2)
print("Co2")
printMatrix(co2Matrix)
energyMatrix = compute_distance_matrix(normalizedEnergyConsumption)
print("\n\nEnergy Consumption")
printMatrix(energyMatrix)
regionMatrix = compute_distance_nominal(df['Region'])
print("\n\nRegion")
printMatrix(regionMatrix)
countryMatrix = compute_distance_nominal(df['Country'])
print("\n\nCountry")
printMatrix(countryMatrix)


finalMatrix= compute_distance_final(co2Matrix, energyMatrix, regionMatrix, countryMatrix)
print("\n\nFinal")
printMatrix(finalMatrix)
